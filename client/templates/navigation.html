<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation - University Room Reservation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
    <style>
        .nav-card {
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            border-radius: 15px;
            overflow: hidden;
        }

        .nav-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nav-card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .nav-card-body {
            padding: 20px;
        }

        .route-btn {
            width: 100%;
            margin-bottom: 10px;
            border-radius: 8px;
            padding: 12px;
            font-weight: 500;
        }

        .role-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.7rem;
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }

        .feature-list li:last-child {
            border-bottom: none;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <i class="fas fa-university me-2"></i>University Room Reservation System
            </a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text">
                    <i class="fas fa-route me-1"></i>Quick Navigation
                </span>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <div class="text-center mb-5">
            <h2><i class="fas fa-compass me-2"></i>System Navigation</h2>
            <p class="lead text-muted">Access all system components and monitoring tools</p>
        </div>

        <div class="row">
            <!-- User Dashboards -->
            <div class="col-md-6 mb-4">
                <div class="card nav-card">
                    <div class="nav-card-header">
                        <h4><i class="fas fa-users me-2"></i>User Dashboards</h4>
                        <p class="mb-0">Role-based interfaces for students and professors</p>
                    </div>
                    <div class="nav-card-body">
                        <a href="/" class="btn btn-primary route-btn">
                            <i class="fas fa-sign-in-alt me-2"></i>Login / Register
                        </a>
                        <div id="role-specific-links">
                            <!-- Links will be populated based on user session -->
                        </div>

                        <ul class="feature-list mt-3">
                            <li><i class="fas fa-check text-success me-2"></i>Make room reservations</li>
                            <li><i class="fas fa-check text-success me-2"></i>Interactive calendar view</li>
                            <li><i class="fas fa-check text-success me-2"></i>Real-time updates</li>
                            <li><i class="fas fa-check text-success me-2"></i>Role-based permissions</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- System Monitoring -->
            <div class="col-md-6 mb-4">
                <div class="card nav-card">
                    <div class="nav-card-header">
                        <h4><i class="fas fa-chart-line me-2"></i>System Monitoring</h4>
                        <p class="mb-0">Real-time system status and network monitoring</p>
                    </div>
                    <div class="nav-card-body">
                        <a href="/monitor" class="btn btn-warning route-btn">
                            <i class="fas fa-chart-line me-2"></i>System Monitor
                        </a>
                        <a href="/blockchain" class="btn btn-secondary route-btn">
                            <i class="fas fa-cubes me-2"></i>Blockchain Explorer
                        </a>

                        <ul class="feature-list mt-3">
                            <li><i class="fas fa-check text-success me-2"></i>Live network status</li>
                            <li><i class="fas fa-check text-success me-2"></i>Connected users tracking</li>
                            <li><i class="fas fa-check text-success me-2"></i>Real-time activity logs</li>
                            <li><i class="fas fa-check text-success me-2"></i>Blockchain visualization</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- API Endpoints -->
            <div class="col-md-6 mb-4">
                <div class="card nav-card">
                    <div class="nav-card-header">
                        <h4><i class="fas fa-code me-2"></i>API Endpoints</h4>
                        <p class="mb-0">Direct access to system APIs for testing</p>
                    </div>
                    <div class="nav-card-body">
                        <a href="/api/rooms" class="btn btn-outline-primary route-btn" target="_blank">
                            <i class="fas fa-door-open me-2"></i>GET /api/rooms
                        </a>
                        <a href="/api/reservations" class="btn btn-outline-primary route-btn" target="_blank">
                            <i class="fas fa-calendar me-2"></i>GET /api/reservations
                        </a>
                        <a href="/api/network-info" class="btn btn-outline-primary route-btn" target="_blank">
                            <i class="fas fa-network-wired me-2"></i>GET /api/network-info
                        </a>
                        <a href="/api/system-status" class="btn btn-outline-primary route-btn" target="_blank">
                            <i class="fas fa-info-circle me-2"></i>GET /api/system-status
                        </a>

                        <ul class="feature-list mt-3">
                            <li><i class="fas fa-check text-success me-2"></i>RESTful API design</li>
                            <li><i class="fas fa-check text-success me-2"></i>JSON responses</li>
                            <li><i class="fas fa-check text-success me-2"></i>Real-time WebSocket</li>
                            <li><i class="fas fa-check text-success me-2"></i>Comprehensive error handling</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Development Tools -->
            <div class="col-md-6 mb-4">
                <div class="card nav-card">
                    <div class="nav-card-header">
                        <h4><i class="fas fa-tools me-2"></i>Development Tools</h4>
                        <p class="mb-0">Testing and debugging utilities</p>
                    </div>
                    <div class="nav-card-body">
                        <button class="btn btn-outline-warning route-btn" onclick="runBusinessLogicTest()">
                            <i class="fas fa-vial me-2"></i>Run Business Logic Tests
                        </button>
                        <button class="btn btn-outline-info route-btn" onclick="checkUserInfo()">
                            <i class="fas fa-user-check me-2"></i>Check User Registration
                        </button>
                        <button class="btn btn-outline-secondary route-btn" onclick="viewBlockchainData()">
                            <i class="fas fa-database me-2"></i>View Raw Blockchain Data
                        </button>
                        <button class="btn btn-outline-danger route-btn" onclick="clearAllData()">
                            <i class="fas fa-trash me-2"></i>Reset System Data
                        </button>

                        <ul class="feature-list mt-3">
                            <li><i class="fas fa-check text-success me-2"></i>Automated testing</li>
                            <li><i class="fas fa-check text-success me-2"></i>User verification</li>
                            <li><i class="fas fa-check text-success me-2"></i>Data inspection</li>
                            <li><i class="fas fa-check text-success me-2"></i>System reset</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Test Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5><i class="fas fa-rocket me-2"></i>Quick Test Credentials</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="text-success"><i class="fas fa-chalkboard-teacher me-2"></i>Professor
                                    Accounts:</h6>
                                <div class="mb-2">
                                    <code>prof-smith | Dr. Smith | smith@university.edu | Block 33</code>
                                </div>
                                <div class="mb-2">
                                    <code>prof-garcia | Dr. Garcia | garcia@university.edu | Block 34</code>
                                </div>
                                <div class="mb-2">
                                    <code>prof-jones | Dr. Jones | jones@university.edu | Block 35</code>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-primary"><i class="fas fa-user-graduate me-2"></i>Student Accounts:</h6>
                                <div class="mb-2">
                                    <code>student-alice | Alice Johnson | alice@university.edu | Block 33</code>
                                </div>
                                <div class="mb-2">
                                    <code>student-bob | Bob Wilson | bob@university.edu | Block 34</code>
                                </div>
                                <div class="mb-2">
                                    <code>student-carol | Carol Davis | carol@university.edu | Block 35</code>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            loadRoleSpecificLinks();
        });

        async function loadRoleSpecificLinks() {
            try {
                // Check if user is logged in by trying to access system status
                const response = await fetch('/api/system-status');
                const data = await response.json();

                // Get current session info
                const sessionResponse = await fetch('/api/user-info/current');
                let userRole = null;

                if (sessionResponse.ok) {
                    const sessionData = await sessionResponse.json();
                    userRole = sessionData.session_user_type;
                }

                let linksHtml = '';

                if (userRole === 'student') {
                    linksHtml = `
                        <a href="/student" class="btn btn-info route-btn">
                            <i class="fas fa-user-graduate me-2"></i>Student Dashboard (Your Role)
                        </a>
                        <div class="alert alert-warning mt-2" role="alert">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Note:</strong> Professor dashboard is restricted to professors only.
                        </div>
                    `;
                } else if (userRole === 'professor') {
                    linksHtml = `
                        <a href="/professor" class="btn btn-success route-btn">
                            <i class="fas fa-chalkboard-teacher me-2"></i>Professor Dashboard (Your Role)
                        </a>
                        <a href="/student" class="btn btn-outline-info route-btn">
                            <i class="fas fa-user-graduate me-2"></i>Student Dashboard (View Only)
                        </a>
                    `;
                } else {
                    linksHtml = `
                        <div class="alert alert-info" role="alert">
                            <i class="fas fa-info-circle me-2"></i>
                            Please login first to access role-specific dashboards.
                        </div>
                        <a href="/" class="btn btn-primary route-btn">
                            <i class="fas fa-sign-in-alt me-2"></i>Login to Access Dashboards
                        </a>
                    `;
                }

                $('#role-specific-links').html(linksHtml);

            } catch (error) {
                $('#role-specific-links').html(`
                    <div class="alert alert-warning" role="alert">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        Unable to determine user role. Please login first.
                    </div>
                    <a href="/" class="btn btn-primary route-btn">
                        <i class="fas fa-sign-in-alt me-2"></i>Go to Login
                    </a>
                `);
            }
        }

        async function runBusinessLogicTest() {
            alert('Business logic tests would run here. Check your terminal for test results when you run: python test_business_logic.py');
        }

        async function checkUserInfo() {
            const userId = prompt('Enter User ID to check:');
            if (userId) {
                try {
                    const response = await fetch(`/api/user-info/${userId}`);
                    const data = await response.json();

                    if (data.success) {
                        alert(`User Info:\n${JSON.stringify(data, null, 2)}`);
                    } else {
                        alert(`Error: ${data.error}`);
                    }
                } catch (error) {
                    alert(`Error checking user: ${error.message}`);
                }
            }
        }

        async function viewBlockchainData() {
            try {
                const response = await fetch('/api/blockchain-data');
                const data = await response.json();

                if (data.success) {
                    console.log('Blockchain Data:', data);
                    alert('Blockchain data logged to console. Press F12 to view.');
                } else {
                    alert(`Error: ${data.error}`);
                }
            } catch (error) {
                alert(`Error: ${error.message}`);
            }
        }

        function clearAllData() {
            if (confirm('This will reset all reservations and user data. Continue?')) {
                alert('System reset functionality would be implemented here.');
            }
        }
    </script>
</body>

</html>